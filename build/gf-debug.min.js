/**
 * @license
 * GrapeFruit Debug Plugin - v0.0.1
 * Copyright (c) 2013, Chad Engler
 * https://github.com/grapefruitjs/gf-debug
 *
 * Compiled: 2013-07-09
 *
 * GrapeFruit Debug Plugin is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
!function(window,undefined){function EntityTracker(cont,ent){this.entity=ent,this.box=document.createElement("div"),d.setStyle(this.box,{position:"absolute",top:"25px",left:"5px",color:"#FFF",border:"solid 1px #1A1A1A","z-index":10,"font-size":"0.9em","background-color":"#222"}),this.label=document.createElement("span"),this.label.textContent="Player Position: ",this.value=document.createElement("span"),this.value.textContent="X: 0, Y: 0",this.label.appendChild(document.createElement("br")),this.label.appendChild(this.value),this.box.appendChild(this.label),cont.appendChild(this.box)}function getGpButtonName(v,i){return"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+gf.input.getGpButtonName(i)+": "+v.toFixed(2)}function getGpAxisName(v,i){return"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+gf.input.getGpAxisName(i)+": "+v.toFixed(2)}function GamepadTracker(cont,game){this.game=game,this.box=document.createElement("div"),d.setStyle(this.box,{position:"absolute",top:"50px",left:"5px",color:"#FFF",border:"solid 1px #1A1A1A","z-index":10,"font-size":"0.9em","background-color":"#222"}),this.value=document.createElement("span"),this.value.textContent="X: 0, Y: 0",this.box.appendChild(this.value),cont.appendChild(this.box)}var document=window.document;!function(w,undefined){"use strict";function newEl(name){return document.createElement(name)}function applyTheme(element,theme){for(var name in theme)try{element.style[name]=theme[name]}catch(e){}return element}function type(value){return null==value?String(value):"object"==typeof value||"function"==typeof value?Object.prototype.toString.call(value).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof value}function inArray(value,array){if("array"!==type(array))return-1;if(array.indexOf)return array.indexOf(value);for(var i=0,l=array.length;l>i;i++)if(array[i]===value)return i;return-1}function extend(){var args=arguments;for(var key in args[1])if(args[1].hasOwnProperty(key))switch(type(args[1][key])){case"object":args[0][key]=extend({},args[0][key],args[1][key]);break;case"array":args[0][key]=args[1][key].slice(0);break;default:args[0][key]=args[1][key]}return args.length>2?extend.apply(null,[args[0]].concat(Array.prototype.slice.call(args,2))):args[0]}function hslToHex(h,s,l){var r,g,b,v,min,sv,sextant,fract,vsf;return v=.5>=l?l*(1+s):l+s-l*s,0===v?"#000":(min=2*l-v,sv=(v-min)/v,h=6*h,sextant=Math.floor(h),fract=h-sextant,vsf=v*sv*fract,0===sextant||6===sextant?(r=v,g=min+vsf,b=min):1===sextant?(r=v-vsf,g=v,b=min):2===sextant?(r=min,g=v,b=min+vsf):3===sextant?(r=min,g=v-vsf,b=v):4===sextant?(r=min+vsf,g=min,b=v):(r=v,g=min,b=v-vsf),"#"+componentToHex(r)+componentToHex(g)+componentToHex(b))}function componentToHex(c){return c=Math.round(255*c).toString(16),1===c.length?"0"+c:c}function listener(element,eventName,handler,remove){element.addEventListener?element[remove?"removeEventListener":"addEventListener"](eventName,handler,!1):element.attachEvent&&element[remove?"detachEvent":"attachEvent"]("on"+eventName,handler)}function FPSMeter(anchor,options){function historyTick(){for(i=o.history;i--;)fpsHistory[i]=0===i?self.fps:fpsHistory[i-1],durationHistory[i]=0===i?self.duration:durationHistory[i-1]}function getHeat(heatmap,value,min,max){return heatmaps[0|heatmap][Math.round(Math.min((value-min)/(max-min)*heatDepth,heatDepth))]}function updateCounter(){el.legend.fps!==showFps&&(el.legend.fps=showFps,el.legend[textProp]=showFps?"FPS":"ms"),count=showFps?self.fps:self.duration,el.count[textProp]=count>999?"999+":count.toFixed(count>99?0:o.decimals)}function render(){if(time=getTime(),lastLoop<time-o.threshold&&(self.fps-=self.fps/Math.max(1,60*o.smoothing/o.interval),self.duration=1e3/self.fps),historyTick(),updateCounter(),o.heat){if(heating.length)for(i=heating.length;i--;)heating[i].el.style[theme[heating[i].name].heatOn]=showFps?getHeat(theme[heating[i].name].heatmap,self.fps,0,o.maxFps):getHeat(theme[heating[i].name].heatmap,self.duration,o.threshold,0);if(el.graph&&theme.column.heatOn)for(i=cols.length;i--;)cols[i].style[theme.column.heatOn]=showFps?getHeat(theme.column.heatmap,fpsHistory[i],0,o.maxFps):getHeat(theme.column.heatmap,durationHistory[i],o.threshold,0)}if(el.graph)for(j=0;j<o.history;j++)cols[j].style.height=(showFps?fpsHistory[j]?Math.round(graphHeight/o.maxFps*Math.min(fpsHistory[j],o.maxFps)):0:durationHistory[j]?Math.round(graphHeight/o.threshold*Math.min(durationHistory[j],o.threshold)):0)+"px"}function requestRender(){o.interval<20?(frameID=rAF(requestRender),render()):(frameID=setTimeout(requestRender,o.interval),renderID=rAF(render))}function eventHandler(event){event=event||window.event,event.preventDefault?(event.preventDefault(),event.stopPropagation()):(event.returnValue=!1,event.cancelBubble=!0),self.toggle()}function removeMeter(){o.toggleOn&&listener(el.container,o.toggleOn,eventHandler,1),anchor.removeChild(el.container)}function setTheme(){if(theme=FPSMeter.theme[o.theme],heatmaps=theme.compiledHeatmaps||[],!heatmaps.length&&theme.heatmaps.length){for(j=0;j<theme.heatmaps.length;j++)for(heatmaps[j]=[],i=0;heatDepth>=i;i++)heatmaps[j][i]=hslToHex(.33/heatDepth*i,theme.heatmaps[j].saturation,theme.heatmaps[j].lightness);theme.compiledHeatmaps=heatmaps}}function createMeter(){el.container&&removeMeter(),setTheme(),el.container=applyTheme(newEl("div"),theme.container),el.count=el.container.appendChild(applyTheme(newEl("div"),theme.count)),el.legend=el.container.appendChild(applyTheme(newEl("div"),theme.legend)),el.graph=o.graph?el.container.appendChild(applyTheme(newEl("div"),theme.graph)):0,heating.length=0;for(var key in el)el[key]&&theme[key].heatOn&&heating.push({name:key,el:el[key]});if(cols.length=0,el.graph)for(el.graph.style.width=o.history*theme.column.width+(o.history-1)*theme.column.spacing+"px",i=0;i<o.history;i++)cols[i]=el.graph.appendChild(applyTheme(newEl("div"),theme.column)),cols[i].style.position="absolute",cols[i].style.bottom=0,cols[i].style.right=i*theme.column.width+i*theme.column.spacing+"px",cols[i].style.width=theme.column.width+"px",cols[i].style.height="0px";positionMeter(),updateCounter(),anchor.appendChild(el.container),el.graph&&(graphHeight=el.graph.clientHeight),o.toggleOn&&("click"===o.toggleOn&&(el.container.style.cursor="pointer"),listener(el.container,o.toggleOn,eventHandler))}function positionMeter(){applyTheme(el.container,o)}"object"===type(anchor)&&anchor.nodeType===undefined&&(options=anchor,anchor=document.body),anchor||(anchor=document.body);var theme,heatmaps,time,frameID,renderID,graphHeight,count,i,j,self=this,o=extend({},FPSMeter.defaults,options||{}),el={},cols=[],heatDepth=100,heating=[],thisFrameTime=0,frameTime=o.threshold,frameStart=0,lastLoop=getTime()-frameTime,fpsHistory=[],durationHistory=[],showFps="fps"===o.show;self.options=o,self.fps=0,self.duration=0,self.isPaused=0,self.tickStart=function(){frameStart=getTime()},self.tick=function(){time=getTime(),thisFrameTime=time-lastLoop,frameTime+=(thisFrameTime-frameTime)/o.smoothing,self.fps=1e3/frameTime,self.duration=lastLoop>frameStart?frameTime:time-frameStart,lastLoop=time},self.pause=function(){return frameID&&(self.isPaused=1,clearTimeout(frameID),cAF(frameID),cAF(renderID),frameID=renderID=0),self},self.resume=function(){return frameID||(self.isPaused=0,requestRender()),self},self.set=function(name,value){return o[name]=value,showFps="fps"===o.show,-1!==inArray(name,rebuilders)&&createMeter(),-1!==inArray(name,repositioners)&&positionMeter(),self},self.showDuration=function(){return self.set("show","ms"),self},self.showFps=function(){return self.set("show","fps"),self},self.toggle=function(){return self.set("show",showFps?"ms":"fps"),self},self.hide=function(){return self.pause(),el.container.style.display="none",self},self.show=function(){return self.resume(),el.container.style.display="block",self},self.destroy=function(){self.pause(),removeMeter(),self.tick=self.tickStart=function(){}},function(){createMeter(),requestRender()}()}var getTime;!function(){var perf=w.performance;if(perf&&(perf.now||perf.webkitNow)){var perfNow=perf.now?"now":"webkitNow";getTime=perf[perfNow].bind(perf)}else getTime=function(){return+new Date}}();var cAF=w.cancelAnimationFrame||w.cancelRequestAnimationFrame,rAF=w.requestAnimationFrame;!function(){for(var vendors=["moz","webkit","o"],lastTime=0,i=0,l=vendors.length;l>i&&!cAF;++i)cAF=w[vendors[i]+"CancelAnimationFrame"]||w[vendors[i]+"CancelRequestAnimationFrame"],rAF=cAF&&w[vendors[i]+"RequestAnimationFrame"];cAF||(rAF=function(callback){var currTime=getTime(),timeToCall=Math.max(0,16-(currTime-lastTime));return lastTime=currTime+timeToCall,w.setTimeout(function(){callback(currTime+timeToCall)},timeToCall)},cAF=function(id){clearTimeout(id)})}();var textProp="string"===type(document.createElement("div").textContent)?"textContent":"innerText";FPSMeter.extend=extend,window.FPSMeter=FPSMeter,FPSMeter.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var rebuilders=["toggleOn","theme","heat","graph","history"],repositioners=["position","zIndex","left","top","right","bottom","margin"]}(window),function(w,FPSMeter){"use strict";FPSMeter.theme={};var base=FPSMeter.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};FPSMeter.theme.dark=FPSMeter.extend({},base,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),FPSMeter.theme.light=FPSMeter.extend({},base,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),FPSMeter.theme.colorful=FPSMeter.extend({},base,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),FPSMeter.theme.transparent=FPSMeter.extend({},base,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter);var d=d||{};EntityTracker.prototype.tick=function(){this.value.textContent="X: "+this.entity.position.x.toFixed(2)+", Y: "+this.entity.position.y.toFixed(2)};var d=d||{};GamepadTracker.prototype.tick=function(){if(this.value.innerHTML="",this.game.input.gamepad.pads&&this.game.input.gamepad.pads.length)for(var i=0,il=this.game.input.gamepad.pads.length;il>i;++i){var pad=this.game.input.gamepad.pads[i];this.value.innerHTML+="Gamepad: ["+pad.index+"] "+pad.id+"<br/>",this.value.innerHTML+="&nbsp;&nbsp;&nbsp;Buttons:<br/>"+pad.buttons.map(getGpButtonName).join("<br/>")+"<br/>",this.value.innerHTML+="&nbsp;&nbsp;&nbsp;Axes:<br/>"+pad.axes.map(getGpAxisName).join("<br/>")+"<br/>"}};var d={_init:!1,show:function(cont,o){if(!o.game)throw"Need to know what game to debug!";d.game=o.game,d.game.on("beforetick",d._beforeTick),d.game.on("aftertick",d._afterTick),o.fps!==!1&&d.showFps(cont,o.fps),o.gamepad!==!1&&d.showGamepad(cont,o.game),o.player&&d.showPlayer(cont,o.player)},showFps:function(cont,o){return d.meter?d.meter:("object"==typeof cont&&cont.nodeType===undefined&&(o=cont,cont=document.body),cont=d._ensureContainer(cont),o=o||{},o.smoothing=o.smoothing||1,o.heat=o.heat!==undefined?o.heat:!0,o.graph=o.graph!==undefined?o.graph:!0,o.history=o.history!==undefined?o.history:25,d.meter=new FPSMeter(cont,o),void 0)},showEntity:function(cont,ent){return d.entity?d.entity:("object"==typeof cont&&cont.nodeType===undefined&&(ent=cont,cont=document.body),cont=d._ensureContainer(cont),ent&&(d.entity=new EntityTracker(cont,ent)),void 0)},showGamepad:function(cont,game){return d.gamepad?d.gamepad:("object"==typeof cont&&cont.nodeType===undefined&&(game=cont,cont=document.body),cont=d._ensureContainer(cont),game&&(d.gamepad=new GamepadTracker(cont,game)),void 0)},_beforeTick:function(){d.meter&&d.meter.tickStart()},_afterTick:function(){d.meter&&d.meter.tick(),d.entity&&d.entity.tick(),d.gamepad&&d.gamepad.tick()},_ensureContainer:function(cont){return"string"==typeof cont&&(cont=document.getElementById(cont)),cont||(cont=document.body),cont},setStyle:function(dom,style){for(var key in style)dom.style[key]=style[key]}};d.version="0.0.1",d.gfVersion="0.0.x",gf.plugin.register(d,"debug")}(window);